import sqlite3

connection = sqlite3.connect("data.db")

cur = connection.cursor()

# #1 create a new user 
# cur.execute("""
#             INSERT INTO user(u_name) VALUES
#                 ('Kevin Hart'), 
#                 ('Frank Ocean')
#                 """)
# connection.commit()

# #2 add new bus route 
# cur.execute("""
#             INSERT INTO routes(r_name, r_routekey, r_availability) VALUES 
#                 ('Dummy Route', 12, 'Weekend' ) 
#                 """)
# connection.commit()

# #3 update bus status to reflect data (starts at 1 not zero)
# cur.execute("""UPDATE busses SET b_status = 2 WHERE b_status = 1""")
# connection.commit() 
# cur.execute("""UPDATE busses SET b_status = 1 WHERE b_status = 0""")
# connection.commit()

# #3 update drivers similarly to busses 
# cur.execute("UPDATE drivers SET d_statuskey = 2 WHERE d_statuskey = 1")
# connection.commit()
# cur.execute("UPDATE drivers SET d_statuskey = 1 WHERE d_statuskey = 0")
# connection.commit()


# #4 organize schedule by route
# cur.execute("SELECT r_name, sc_time, bs_name FROM schedule JOIN routes ON r_routekey = sc_routekey JOIN busstops ON bs_stopkey = sc_stopkey WHERE r_name = \"Bobcat Express\" ORDER BY sc_time")
# rows = cur.fetchall()
# for row in rows:
#     print(row)

# #5 log bus usage from student
# cur.execute("INSERT INTO usebus(ubu_id, ubu_buskey, ubu_bs_on, ubu_bs_off) VALUES(3, 1, 1, 3)")
# connection.commit()

# #6 assign drivers to busses 
# cur.execute("UPDATE drivers SET d_buskey=1 WHERE d_name='Simon Ventura'")
# connection.commit()

# #7 look for which routes contain a certain stop
# cur.execute("SELECT DISTINCT(r_name) FROM routes JOIN schedule ON sc_routekey = r_routekey JOIN busstops ON bs_stopkey = sc_stopkey WHERE bs_name = \"University Transit Center (UTC)\"")
# rows = cur.fetchall()
# for row in rows:
#     print(row)
# connection.commit()

# #8 Assigning a bus to a route 
# cur.execute("UPDATE busses SET b_routekey=1 WHERE b_buskey = 1")
# connection.commit() 
# cur.execute("UPDATE busses SET b_routekey=11 WHERE b_buskey = 2")
# connection.commit() 

# #9 Updating Status of Drivers to begginning of day 
# cur.execute("UPDATE drivers SET d_statuskey=2 WHERE d_statuskey=1")
# connection.commit()
# cur.execute("UPDATE drivers SET d_statuskey=1 WHERE d_statuskey=0")
# connection.commit()
# cur.execute("UPDATE drivers SET d_statuskey=3 WHERE d_statuskey=2")
# connection.commit() 

#10 Active Busses THIS DOES NOT WORK IDK WHY 
cur.execute("SELECT DISTINCT * FROM busses WHERE b_status=2")
rows = cur.fetchall()
for row in rows:
    print(row)
connection.commit()
#THIS DOES NOT WORK IDK WHY 

# #11 look for what times there's a bus departing from a specific stop
# cur.execute("SELECT r_name, sc_time FROM schedule JOIN routes ON r_routekey = sc_routekey JOIN busstops ON bs_stopkey = sc_stopkey WHERE bs_name=\"Granville Apartments\" ORDER BY bs_name, sc_time")
# rows = cur.fetchall()
# for row in rows:
#     print(row)
# connection.commit()

# #12 look for which routes run on the weekends
# cur.execute("SELECT r_name FROM routes WHERE r_availability = \"Weekday\"")
# rows = cur.fetchall()
# for row in rows:
#     print(row)
# connection.commit()

# look for which stops depart at a specific time
cur.execute("SELECT bs_name FROM busstops JOIN schedule ON sc_stopkey = bs_stopkey WHERE sc_time = \"8:22 AM\"")
rows = cur.fetchall()
for row in rows:
    print(row)
connection.commit()


connection.close()